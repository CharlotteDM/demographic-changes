---
title: "Demographic Changes"
author: "Karolina DM"
output: html_document
---

```{r setup, include=FALSE}
source("DemographicChanges.R")
library("knitr")
library("tidyverse")
library("plotly")
library("htmlwidgets")
```


## __Discussion__

### This is a report about demographic changes in the world since 1960 to 2019. 

__Fertility Rate__ (total, births per woman) is:

> "rate represents the number of children that would be born to a woman if she were to live to the end of her childbearing years and bear children in accordance with age-specific fertility rates of the specified year".

(source of definition & data: https://data.worldbank.org/indicator/SP.DYN.TFRT.IN)


The country with the highest fertility rate in 2019 is 
__`r HighFertRat$Country.Name`__. The fertility rate is 
__`r HighFertRat$hfr`__.

The country with the lowest fertility rate in 2019 is 
__`r LowFertRat$Country.Name`__. The fertility rate is 
__`r LowFertRat$lfr`__.

This is the list of countries with the highest fertility rate (ordered by highest to lowest). Table shows fertility rate difference declining from 1960 to 2019.

```{r top_10_hfr, echo=FALSE}
kable(top_10_hfr, col.names = c("Country", "Fertility Rate drop since 1960 to 2019"))
```

This map shows fertility rate in 2019. 

```{r , echo=FALSE}
mapCountryData(
  comb_data_map_fr,
  mapTitle = "Fertility Rate in 2019",
  nameColumnToPlot = "X2019",
  colourPalette = brewer.pal(7, "RdPu")
)
```

The country of EU with the highest fertility rate in 2019 is 
__`r EU_HighFertRat$Country.Name`__. The fertility rate is 
__`r EU_HighFertRat$eu_hfr`__.
The high fertility rate in France is the result of counting a combined result with dependent territories in the whole world (e.g. French Guiana).

The country of EU with the lowest fertility rate in 2019 is 
__`r EU_LowFertRat$Country.Name`__. The fertility rate is 
__`r EU_LowFertRat$eu_lfr`__.

This map shows fertility rate in EU countries in 2019. 

```{r , echo=FALSE}
mapCountryData(
  comb_data_map_eu_fr,
  mapTitle = "Fertility Rate in 2019 in EU",
  nameColumnToPlot = "X2019",
  colourPalette = brewer.pal(7, "RdPu")
)
```

This chart shows fertility rate in EU countries in 2019.

```{r EU_FR=plot, dev='png', echo=FALSE}
plot(EU_FR)
```

There are many correlates of the fertility rate. One of them is the age of the mother when she gives birth to her first child. 
Correlation between fertility rate and mean age of woman at birth first child is
__```r cor(comb_data_agewom_fr$X2019, comb_data_agewom_fr$OBS_VALUE, use = "complete.obs")```__
The higher the age of birth of the first child, the lower the fertility rate.

This chart shows fertility rate and mean age of woman at birth first child (in EU countries in 2019).

```{r ggFR=plot, dev='png', echo = FALSE}
plot(ggFR)
```

As we can see in Eastern European countries belonging to the EU, the fertility rate is higher and the age of women giving birth to the first child is lower than in other EU countries

One of the potential correlates of fertility rate and the age at which women give birth to first child may be a greater prevalence of contraception and therefore - more frequent use of it.
Correlation between fertility rate and prevalence of contraceptive methods is
__```r cor(comb_data_agewom_fr_contr$X2019, comb_data_agewom_fr_contr$AnyMethod, use = "complete.obs")```__ This correlation is really weak. 

(Source of data about prevalence of contraceptive methods in EU countries: https://www.un.org/development/desa/pd/sites/www.un.org.development.desa.pd/files/files/documents/2020/Jan/un_2019_contraceptiveusebymethod_databooklet.pdf)


This interactive graph shows the distribution of the variables: the fertility rate, the average age of the first child's birth, and the prevalence of contraception used (click dot on chart for more information).

```{r plt=ggplotly, echo=FALSE, error=FALSE, warning=FALSE}
ggplotly(plt)
```


One another correlates of fertility rate could be GCP per capita, which is:

> The indicator is calculated as the ratio of real GDP to the average population of a specific year. GDP measures the value of total final output of goods and services produced by an economy within a certain period of time. It includes goods and services that have markets (or which could have markets) and products which are produced by general government and non-profit institutions. It is a measure of economic activity and is also used as a proxy for the development in a countryâ€™s material living standards. However, it is a limited measure of economic welfare. For example, neither does GDP include most unpaid household work nor does GDP take account of negative effects of economic activity, like environmental degradation".

(data & definition source: https://ec.europa.eu/eurostat/databrowser/view/sdg_08_10/default/table).

We want to check if GCP correlates with the factors discussed earlier.


__Death Rate__ (crude, per 1000 people) indicates: 

> "the number of deaths occurring during the year, per 1,000 population estimated at midyear. Subtracting the crude death rate from the crude birth rate provides the rate of natural increase, which is equal to the rate of population change in the absence of migration".

(data & definition source: https://data.worldbank.org/indicator/SP.DYN.CDRT.IN)

The country with the highest death rate in 2019 is 
__`r HighDeathRat$Country.Name`__. The death rate is 
__`r HighDeathRat$hdr`__.

The country with the lowest death rate in 2019 is 
__`r LowDeathRat$Country.Name`__. The death rate is 
__`r LowDeathRat$ldr`__.

This is the list of countries with the highest death rate (ordered by highest to lowest). Table shows death rate difference declining from 1960 to 2019.

```{r top_10_hdr, echo=FALSE}
kable(top_10_hdr, col.names = c("Country", "Death Rate increase since 1960 to 2019"))
```

This map show death rate in 2019. 

```{r , echo=FALSE}
mapCountryData(
  comb_data_map_dr,
  mapTitle = "Death Rate in 2019",
  nameColumnToPlot = "X2019",
  colourPalette = brewer.pal(7, "Blues")
)
```

Birth Rate (crude, per 1000 people) is: 

>Crude birth rate indicates the number of live births occurring during the year, per 1,000 population estimated at midyear. Subtracting the crude death rate from the crude birth rate provides the rate of natural increase, which is equal to the rate of population change in the absence of migration.

(data & definition source: https://data.worldbank.org/indicator/SP.DYN.CBRT.IN)

The country with the highest birth rate in 2019 is 
`r HighBirthRat$Country.Name`. The birth rate is 
`r HighBirthRat$hbr`.

The country with the lowest birth rate in 2019 is 
`r LowBirthRat$Country.Name`. The birth rate is 
`r LowBirthRat$lbr`.

This is the list of countries with the highest birth rate (ordered by highest to lowest). Table shows birth rate difference declining from 1960 to 2019.

```{r top_10_hbr, echo=FALSE}
kable(top_10_hbr, col.names = c("Country", "Birth Rate drop since 1960 to 2019"))
```

This map show birth rate in 2019. 

```{r , echo=FALSE}
mapCountryData(
  comb_data_map_br,
  mapTitle = "Birth Rate in 2019",
  nameColumnToPlot = "X2019",
  colourPalette = brewer.pal(7, "Greens")
)
```

Life expectancy at birth (total, years): 

>indicates the number of years a newborn infant would live if prevailing patterns of mortality at the time of its birth were to stay the same throughout its life.

(data & definition source: https://data.worldbank.org/indicator/SP.DYN.LE00.IN)

The country with the highest life expectancy in 2019 is 
`r HighLifeExpect$Country.Name`. The life expectancy rate is 
`r HighLifeExpect$hle`.

The country with the lowest life expectancy in 2019 is 
`r LowLifeExpect$Country.Name`. The life expectatancy is 
`r LowLifeExpect$lle`.

This is the list of countries with the largest life expectancy gains from 1960 to 2019

```{r top_10_hleg, echo=FALSE}
kable(top_10_hleg, col.names = c("Country", "The greatest increase since 1960 to 2019 (in years)"))
```

This map show life expectrancy in 2019. 

```{r , echo=FALSE}
mapCountryData(
  comb_data_map_le,
  mapTitle = "Life expectancy in 2019",
  nameColumnToPlot = "X2019",
  colourPalette = brewer.pal(7, "Purples")
)
```
